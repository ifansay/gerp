generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["tracing", "views", "relationJoins", "metrics"]
}

datasource db {
  provider          = "mysql"
  url               = env("DATABASE_URL")
  directUrl         = env("DIRECT_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

generator erd {
  provider     = "prisma-erd-generator"
  ignoreTables = ["_prisma_migrations", "Session", "Account", "Example"]
  disabled     = false
  ignoreEnums  = true
  output       = "database.svg"
}

model e_listing {
  id                  Int                 @id @default(autoincrement())
  platform_code       String
  market_id           Int
  country_code        String
  item_id             String
  msku                String
  sku                 String
  spu                 String
  spu_name            String
  warehouse_id        Int
  e_market_polymerize e_market_polymerize @relation(fields: [market_id], references: [id])
  e_product           e_product           @relation(fields: [sku], references: [sku])
  e_warehouse         e_warehouse         @relation(fields: [warehouse_id], references: [id])
}

model e_market_polymerize {
  id                  Int           @id @default(autoincrement())
  platform_code       String
  country_name        String
  platform_name       String
  disable_Subaccounts Int
  session             Int
  market_name         String
  e_market            e_market      @relation(fields: [market_id], references: [id])
  erp_shop_info       erp_shop_info @relation(fields: [market_id], references: [id])
  e_vc_market         e_vc_market   @relation(fields: [market_id], references: [id])
  warehouse           e_warehouse   @relation(fields: [warehouse_id], references: [id])
  awd_warehouse       e_warehouse   @relation(fields: [awd_warehouse_id], references: [id])
  e_listing           e_listing[]
}

model e_product {
  id                       Int                      @id @default(autoincrement())
  sku                      String
  small_image_url          String
  name                     String
  name_print               String
  brief_name               String
  category                 String
  brand                    String
  group_name               String
  e_product_category       e_product_category       @relation(fields: [category], references: [value])
  e_product_brand          e_product_brand          @relation(fields: [brand], references: [code])
  product_manager          sys_account              @relation(fields: [product_manager_account_id], references: [biz_id])
  purchase_account         sys_account              @relation(fields: [purchase_account_id], references: [biz_id])
  e_listing                e_listing[]
  e_parent_product_product e_parent_product_product

  @@index([sku], name: "sku")
}

model e_warehouse {
  id                  Int                   @id @default(autoincrement())
  server_id           Int
  platform_code       String
  name                String
  type                String
  parent_type         String
  country             String
  e_listing           e_listing[]
  e_market_polymerize e_market_polymerize[]
  platform_market     platform_market[]
}

model e_market {
  id                  Int                 @id @default(autoincrement())
  server_id           Int
  name                String
  alias               String
  country_id          Int
  disable_reason      String
  e_market_polymerize e_market_polymerize
}

model platform_market {
  id                   Int                   @id @default(autoincrement())
  market_polymerize_id Int
  tenant_code          String
  country              String
  market_name          String
  e_warehouse          e_warehouse           @relation(fields: [platform_warehouse_id], references: [id])
  e_market_polymerize  e_market_polymerize[]
}

model e_vc_market {
  id                  Int                   @id @default(autoincrement())
  seller_name         String
  country_id          Int
  country_code        String
  e_market_polymerize e_market_polymerize[]
}

model e_product_category {
  id              Int         @id @default(autoincrement())
  name            String
  value           String
  parent_category String
  e_product       e_product[]

  @@unique([value], name: "value_unique")
}

model e_product_brand {
  id        Int         @id @default(autoincrement())
  code      String
  name      String
  e_product e_product[]

  @@unique([code], name: "code_unique")
}

model sys_account {
  id                Int                 @id @default(autoincrement())
  biz_id            Int
  login_name        String
  tenant_code       String
  name              String
  e_listing_manager e_listing_manager[]
  e_product         e_product[]
  e_parent_product  e_parent_product[]

  @@unique([biz_id], name: "biz_id_unique")
}

model e_listing_manager {
  id              Int         @id @default(autoincrement())
  listing_id      Int
  manager_id      Int
  manager_user_id Int
  e_listing       e_listing   @relation(fields: [listing_id], references: [id])
  sys_account     sys_account @relation(fields: [manager_id], references: [id])
}

model e_parent_product_product {
  id                  Int              @id @default(autoincrement())
  parent_product_code String
  product             String
  e_parent_product    e_parent_product @relation(fields: [parent_product_code], references: [code])
  e_product           e_product        @relation(fields: [product], references: [sku])
}

model e_parent_product {
  id                       Int                        @id @default(autoincrement())
  code                     String
  name                     String
  sys_account              sys_account                @relation(fields: [p_product_manager_account_id], references: [biz_id])
  e_parent_product_product e_parent_product_product[]

  @@unique([code], name: "code_unique")
}
